<!DOCTYPE html>
<!--
  ~
  ~ Copyright 2018 Damian Perera
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~     
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  ~ index.html in foras
  ~ Created by Damian Perera on 2/27/2018
  ~
  -->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Foras - Monitoring Dashboard</title>
    <link rel="icon" type="image/png" href="assets/images/favicon.png"><!-- Major Browsers -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link href="https://use.fontawesome.com/releases/v5.0.7/css/all.css" rel="stylesheet">
    <style type="text/css">
        @media (min-width: 576px) {
            nav {
                max-width: 540px;
            }
        }
        @media (min-width: 768px) {
            nav {
                max-width: 720px;
            }
        }
        @media (min-width: 992px) {
            nav {
                max-width: 960px;
            }
            .container {
                margin-top: 5% !important;
                margin-bottom: 2% !important;
                height: 86vh !important;
            }
        }
        @media (min-width: 1200px) {
            nav {
                max-width: 1140px;
            }
            .container {
                margin-top: 6.5% !important;
                margin-bottom: 1.5% !important;
                height: 85vh !important;
            }
        }
        nav {
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
            margin-right: auto;
            margin-left: auto;
        }
        #footer {
            font-size: 12px;
            color: white;
        }
        a {
            text-decoration: none !important;
            color: darkkhaki;
        }
        a:hover {
            text-decoration: none;
            color: khaki;
        }
        .container {
            background-color: white;
            overflow-y: scroll;
        }
        ::-webkit-scrollbar {
            display: none;
        }
        .clock {
            float: right;
            height: 2vh;
            color: #ffffff;
            font-size: 1.5vh;
            font-family: sans-serif;
            line-height: 2.4vh;
            display: flex;
            position: relative;
            /*background: green;*/
            overflow: hidden;
        }
        .clock::before, .clock::after {
            content: '';
            width: 7ch;
            height: 3vh;
            position: absolute;
            z-index: 2;
        }
        .clock::after {
            bottom: 0;
        }
        .clock > div {
            display: flex;
        }
        .tick {
            line-height: 2vh;
        }

        .info-box {
            display: block;
            min-height: 90px;
            background: #fff;
            width: 100%;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
            border-radius: 2px;
            margin-bottom: 15px;
        }

        .bg-green {
            background-color: limegreen !important;
        }

        .bg-red {
            background-color: indianred !important;
        }

        .bg-red, .bg-green {
            color: #fff !important;
        }

        .info-box-icon {
            border-radius: 2px 0 0 2px;
            display: block;
            float: left;
            height: 90px;
            width: 90px;
            text-align: center;
            font-size: 45px;
            line-height: 90px;
            background: rgba(0, 0, 0, 0.2);
        }

        .info-box-content {
            padding: 5px 10px;
            margin-left: 90px;
        }

        .info-box-text {
            text-transform: uppercase;
        }

        .info-box-text {
            display: block;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .info-box-number {
            display: block;
            font-weight: bold;
            font-size: 14px;
        }

        #info-boxes {
            min-height: 250px;
            margin-right: auto;
            margin-left: auto;
        }

        .under-construction {
            color: red;
            font-size: 11.5px;
            text-transform: uppercase;
        }
        .card {
            width: 100%;
            margin-bottom: 2%;
        }
        pre {
            width: 115% !important;
            height: 310px !important;
            overflow: scroll;
            border: 1px solid #ced4da !important;
            border-radius: .25rem;
        }
        textarea {
            height: 310px !important;
            overflow: scroll;
        }
        .btn-group-vertical {
            text-align: center;
        }
        #module-buttons {
            margin-top: 0.5%;
            margin-left: 15px;
        }
        .btn:focus,.btn:active {
            outline: none !important;
            box-shadow: none;
        }
        #spinner {
            left: 20%;
            margin-top: 10%;
        }
        .Blink {
            animation: blinker 1.5s cubic-bezier(.5, 0, 1, 1) infinite alternate;
        }
        @keyframes blinker {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
</head>
<body>
<nav class="navbar fixed-top navbar-dark bg-dark">
    <a class="navbar-brand" href="#">
        <h4><span class="badge badge-light">FORAS</span>
            <small>Module Demo</small>
        </h4>
    </a>
    <div class="clock">
        <div class="hours">
            <div class="first">
                <div class="number">0</div>
            </div>
            <div class="second">
                <div class="number">0</div>
            </div>
        </div>
        <div class="tick">:</div>
        <div class="minutes">
            <div class="first">
                <div class="number">0</div>
            </div>
            <div class="second">
                <div class="number">0</div>
            </div>
        </div>
        <div class="tick">:</div>
        <div class="seconds">
            <div class="first">
                <div class="number">0</div>
            </div>
            <div class="second infinite">
                <div class="number">0</div>
            </div>
        </div>
    </div>
</nav>
<div class="container" ng-app="foras-demo">
    <div class="row">
        <div class="row" id="info-boxes">
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-green"><i class="fab fa-searchengin"></i></span>

                    <div class="info-box-content"">
                        <span class="info-box-text">Code Suggester</span>
                        <span class="info-box-number"><i class="fa fa-circle text-danger Blink"></i> ACTIVE</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-green"><i class="fas fa-language"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Syntax Checker</span>
                        <span class="info-box-number"><i class="fa fa-circle text-danger Blink"></i> ACTIVE</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->

            <!-- fix for small devices only -->
            <div class="clearfix visible-sm-block"></div>

            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-green"><i class="fas fa-linter"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Code Linter</span>
                        <span class="info-box-number"><i class="fa fa-circle text-danger Blink"></i> ACTIVE</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-green"><i class="fas fa-magic"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Auto Corrector</span>
                        <span class="info-box-number"><i class="fa fa-circle text-danger Blink"></i> ACTIVE</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-red"><i class="fas fa-terminal"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Remote Terminal</span>
                        <span class="info-box-number under-construction">Under Construction</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-red"><i class="fas fa-code-branch"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Code Deploy</span>
                        <span class="info-box-number under-construction">Under Construction</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-red"><i class="fas fa-exclamation"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Error Monitor</span>
                        <span class="info-box-number under-construction">Under Construction</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="info-box">
                    <span class="info-box-icon bg-red"><i class="fas fa-file-code"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Remote Logger</span>
                        <span class="info-box-number under-construction">Under Construction</span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>
            <!-- /.col -->
        </div>
    </div>
    <div class="row">
        <div class="card bg-dark text-white">
            <div class="card-body">
                <b>Test Cloud Modules</b>
            </div>
        </div>
    </div>
    <div class="row" id="demo" ng-controller="modules">
        <div class="col-sm-5">
            <div class="js-input">
                <textarea ng-model="jsCode" class="form-control" rows="3" placeholder="JavaScript Code"></textarea>
            </div>
        </div>
        <div class="col-sm-1" id="module-buttons">
            <div class="btn-group-vertical" align="center">
                <button type="button" class="btn btn-secondary" ng-click="codeSuggester()" data-toggle="tooltip" data-placement="left" title="Code Suggester"><i class="fab fa-searchengin"></i></button>
                <button type="button" class="btn btn-secondary" ng-click="syntaxChecker()" data-toggle="tooltip" data-placement="left" title="Syntax Checker"><i class="fas fa-language"></i></button>
                <button type="button" class="btn btn-secondary" ng-click="codeLinter()" data-toggle="tooltip" data-placement="left" title="Code Linter"><i class="fas fa-linter"></i></button>
                <button type="button" class="btn btn-secondary" ng-click="autoCorrector()" data-toggle="tooltip" data-placement="left" title="Auto Corrector"><i class="fas fa-magic"></i></button>
                <button type="button" class="btn btn-secondary disabled"><i class="fas fa-terminal"></i></button>
                <button type="button" class="btn btn-secondary disabled"><i class="fas fa-code-branch"></i></button>
                <button type="button" class="btn btn-secondary disabled"><i class="fas fa-exclamation"></i></button>
                <button type="button" class="btn btn-secondary disabled"><i class="fas fa-file-code"></i></button>
            </div>
        </div>
        <div id="spinner" class="col-sm-5" ng-if="spinner == true">
            <i class="fas fa-spinner fa-spin fa-w-16 fa-3x"></i>
        </div>
        <div class="col-sm-5" ng-if="spinner == false">
            <pre class="code-output prettyprint"><code>{{result | json}}</code></pre>
        </div>
    </div>
</div>
<nav id="footer" class="navbar fixed-bottom navbar-dark bg-dark">
    <p class="mb-0">&copy; 2018 Damian Perera | Licensed under the <a target="_blank"
                                                                      href="http://www.apache.org/licenses/LICENSE-2.0">Apache
        License 2.0</a></p>
</nav>
<script>
    // 24h clock
    let hoursContainer = document.querySelector('.hours');
    let minutesContainer = document.querySelector('.minutes');
    let secondsContainer = document.querySelector('.seconds');
    let tickElements = Array.from(document.querySelectorAll('.tick'));

    let last = new Date(0);
    last.setUTCHours(-1);

    function updateTime() {
        let now = new Date;

        let lastHours = last.getHours().toString();
        let nowHours = now.getHours().toString();
        if (lastHours !== nowHours) {
            updateContainer(hoursContainer, nowHours)
        }

        let lastMinutes = last.getMinutes().toString();
        let nowMinutes = now.getMinutes().toString();
        if (lastMinutes !== nowMinutes) {
            updateContainer(minutesContainer, nowMinutes)
        }

        let lastSeconds = last.getSeconds().toString();
        let nowSeconds = now.getSeconds().toString();
        if (lastSeconds !== nowSeconds) {
            //tick()
            updateContainer(secondsContainer, nowSeconds)
        }

        last = now
    }

    function tick() {
        tickElements.forEach(t => t.classList.toggle('tick-hidden'))
    }

    function updateContainer(container, newTime) {
        let time = newTime.split('');

        if (time.length === 1) {
            time.unshift('0')
        }


        let first = container.firstElementChild;
        if (first.lastElementChild.textContent !== time[0]) {
            updateNumber(first, time[0])
        }

        let last = container.lastElementChild;
        if (last.lastElementChild.textContent !== time[1]) {
            updateNumber(last, time[1])
        }
    }

    function updateNumber(element, number) {
        //element.lastElementChild.textContent = number
        let second = element.lastElementChild.cloneNode(true);
        second.textContent = number;

        element.appendChild(second);
        element.classList.add('move');

        setTimeout(function () {
            element.classList.remove('move')
        }, 990);
        setTimeout(function () {
            element.removeChild(element.firstElementChild)
        }, 990)
    }

    setInterval(updateTime, 100)
</script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<script>
    let app = angular.module("foras-demo", []);
    app.controller("modules", function($scope, $http, $httpParamSerializerJQLike) {
        $scope.jsCode = "";
        $scope.spinner = false;
        $scope.codeSuggester = function () {
            if($scope.jsCode !== "") {
                $scope.spinner = true;
                $http({
                    method : "GET",
                    url : "/search/code/js/" + $scope.jsCode
                }).then(
                    function success(response) {
                        $scope.spinner = false;
                        $scope.result = response.data;
                    }, function error(response) {
                        $scope.result = response.statusText;
                    });
            }

        };
        $scope.syntaxChecker = function () {
            if($scope.jsCode !== "") {
                $scope.spinner = true;
                $http({
                    method : "POST",
                    url : "/syntax/check",
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    data: $httpParamSerializerJQLike({
                        code: $scope.jsCode,
                        filename: 'demo.js'
                    })
                }).then(
                    function success(response) {
                        $scope.spinner = false;
                        $scope.result = response.data;
                    }, function error(response) {
                        $scope.result = response.statusText;
                    });
            }
        };
        $scope.codeLinter = function () {
            if($scope.jsCode !== ""){
                $scope.spinner = true;
                $http({
                    method : "POST",
                    url : "/syntax/lint",
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    data: $httpParamSerializerJQLike({
                        code: $scope.jsCode,
                        filename: 'demo.js',
                        fix: false
                    })
                }).then(
                    function success(response) {
                        $scope.spinner = false;
                        $scope.result = response.data;
                    }, function error(response) {
                        $scope.result = response.statusText;
                    });
            }

        };
        $scope.autoCorrector = function () {
            if($scope.jsCode !== "") {
                $scope.spinner = true;
                $http({
                    method : "POST",
                    url : "/syntax/lint",
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    data: $httpParamSerializerJQLike({
                        code: $scope.jsCode,
                        filename: 'demo.js',
                        fix: true
                    })
                }).then(
                    function success(response) {
                        $scope.spinner = false;
                        $scope.result = response.data;
                    }, function error(response) {
                        $scope.result = response.statusText;
                    });
            }
        };
    });
</script>
<script>
    // Enable tooltips
    $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
</body>
</html>